{
  "asset_name": "maintenance_tasktypes.lib",
  "run_group": "daily",
  "active": true,
  "tasks": [
    {
      "type": "aggregate",
      "active": true,
      "source_location": {
        "temp_table": "maintenance_tasktypes_temp.lib",
        "aggregate": "maintenance_tasktypes",
        "data_range": "A3:B",
        "data_connection": "bedrock-googlesheets",
        "append_tab_name": false
      },
      "target_location": {
        "asset": "maintenance_tasktypes.lib"
      }
    },
    {
      "type": "sql",
      "active": true,
      "connection": "pubrecdb1/mdastore1/dbadmin",
      "sql_string": "DELETE from internal.maintenance_tasktypes a\nUSING (SELECT task_type, maintenance_need, \nROW_NUMBER() OVER(PARTITION BY task_type, maintenance_need) AS DuplicateCount\nFROM internal.maintenance_tasktypes) b\nwhere a.task_type is null or (a.task_type = b.task_type \nand a.maintenance_need  = b.maintenance_need \nand DuplicateCount > 1);"
    }
  ]
}